webpackJsonp([0],{190:function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function o(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}function i(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}t.d(n,"a",function(){return v});var a=t(11),c=t.n(a),u=t(48),s=t(218),l=t(96),f=t(23),d=t(226),p=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),v=function(e){function n(e,t){r(this,n);var i=o(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e,t)),a=i.store=s.a();return l.a.setCallbacks({onConnecting:function(){return a.dispatch(f.c())},onConnected:function(){return a.dispatch(f.b())},onDisconnected:function(){return a.dispatch(f.f())},onMessage:function(e){return a.dispatch(f.g(e))},onError:function(e){return window.console.error(e)}}),i}return i(n,e),p(n,[{key:"render",value:function(){return c.a.createElement(u.Provider,{store:this.store},c.a.createElement(d.a,null))}}]),n}(c.a.Component)},218:function(e,n,t){"use strict";var r=t(30),o=t(94),i=(t.n(o),t(95)),a=t.n(i),c=t(219);n.a=function(){var e=[a.a];return r.createStore(c.a,r.applyMiddleware.apply(void 0,e))}},219:function(e,n,t){"use strict";var r=t(30),o=t(220),i=t(224),a=t(225);n.a=r.combineReducers({connection:o.a,controls:a.a,telemetry:i.a})},220:function(e,n,t){"use strict";var r=t(23),o=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},i={isConnected:!1,isConnecting:!1};n.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;switch(arguments[1].type){case r.d.CONNECTED:return o({},e,{isConnecting:!1,isConnected:!0});case r.d.CONNECTING:return o({},e,{isConnecting:!0,isConnected:!1});case r.d.DISCONNECTED:return o({},e,{isConnecting:!1,isConnected:!1});default:return e}}},221:function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}t.d(n,"a",function(){return i});var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),i=function(){function e(n,t){var o=t.onOpen,i=t.onClose,a=t.onMessage,c=t.onError;r(this,e),this.connection=new WebSocket(n),this.connection.onopen=o,this.connection.onclose=i,this.connection.onmessage=a,this.connection.onerror=c}return o(e,[{key:"send",value:function(e){this.connection.send(JSON.stringify(e))}},{key:"close",value:function(){this.connection.close()}}]),e}()},222:function(e,n,t){"use strict";t.d(n,"a",function(){return r});var r=function(e){return new Promise(function(n,t){try{var r=JSON.parse(e),o=r.control,i=o.flaps,a=o.landing_gear,c=r.telemetry,u=c.airspeed,s=c.altitude;u<0||s<0||s>1e5?t("Received (probably) invalid data: "+e):n({control:{flaps:i,landing_gear:a},telemetry:{airspeed:u,altitude:s}})}catch(n){t("Received incorrectly formatted data: "+e)}})}},223:function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}t.d(n,"a",function(){return i});var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),i=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3e4;r(this,e),this._windowSize=n,this._minRecord=1/0,this._maxRecord=-1/0,this._records=[]}return o(e,[{key:"update",value:function(e){this._minRecord=Math.min(e,this._minRecord),this._maxRecord=Math.max(e,this._maxRecord);var n=Date.now();this._records.push({t:n,d:e});var t=n-this._windowSize,r=this._records.findIndex(function(e){return e.t>t});-1!==r&&(this._records=this._records.slice(r))}},{key:"min",get:function(){return this._minRecord===1/0?null:this._minRecord}},{key:"max",get:function(){return this._maxRecord===-1/0?null:this._maxRecord}},{key:"average",get:function(){var e=this.length;return e?this._records.reduce(function(e,n){return e+n.d},0)/e:null}},{key:"length",get:function(){return this._records.length}}]),e}()},224:function(e,n,t){"use strict";var r=t(23),o=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},i={airspeed:0,altitude:0,minSpeed:0,maxSpeed:0,averageSpeed:0,minAltitude:0,maxAltitude:0,averageAltitude:0};n.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,n=arguments[1];switch(n.type){case r.d.RECEIVE_DATA:return o({},e,n.payload.telemetry);case r.d.DISCONNECTED:return o({},e,{airspeed:0,altitude:0});default:return e}}},225:function(e,n,t){"use strict";var r=t(23),o=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},i={landingGear:0,flaps:0};n.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,n=arguments[1];switch(n.type){case r.d.RECEIVE_DATA:var t=n.payload.control,a=t.landing_gear,c=t.flaps;return o({},e,{landingGear:a,flaps:c});case r.d.TOGGLE_LANDING_GEAR:var u=n.payload.on;return o({},e,{landingGear:u});case r.d.SET_FLAPS_POSITION:var s=n.payload.position;return o({},e,{flaps:s});default:return e}}},226:function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function o(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}function i(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}t.d(n,"a",function(){return h});var a,c,u=t(11),s=t.n(u),l=t(48),f=t(23),d=t(227),p=t(230),v=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),h=(a=l.connect(function(e){return{controls:e.controls,telemetry:e.telemetry,connection:e.connection}},{toggleLandingGear:f.i,setFlapsPosition:f.h,connectToServer:f.a,disconnectFromServer:f.e}))(c=function(e){function n(){return r(this,n),o(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return i(n,e),v(n,[{key:"componentDidMount",value:function(){this.props.connectToServer()}},{key:"componentWillUnmount",value:function(){this.props.disconnectFromServer()}},{key:"render",value:function(){var e=this.props,n=e.telemetry,t=e.controls,r=e.connection,o=e.connectToServer,i=e.disconnectFromServer,a=e.toggleLandingGear,c=e.setFlapsPosition,u=n.airspeed,l=n.minSpeed,f=n.maxSpeed,v=n.averageSpeed,h=n.altitude,m=n.minAltitude,g=n.maxAltitude,y=n.averageAltitude,b=t.landingGear,E=t.flaps,_=r.isConnected,C=r.isConnecting;return s.a.createElement("div",{id:"dashboard"},s.a.createElement(d.d,{id:"speedometer",value:u,max:"500"}),s.a.createElement(d.c,{id:"altimeter",value:h/1e3,max:"10"}),s.a.createElement(d.g,{id:"numeric-speed",value:u}),s.a.createElement(d.e,{id:"numeric-speed-min",value:l}),s.a.createElement(d.e,{id:"numeric-speed-max",value:f}),s.a.createElement(d.e,{id:"numeric-speed-ave",value:v}),s.a.createElement(d.f,{id:"numeric-altitude",value:h/1e3}),s.a.createElement(d.e,{id:"numeric-altitude-min",value:m}),s.a.createElement(d.e,{id:"numeric-altitude-max",value:g}),s.a.createElement(d.e,{id:"numeric-altitude-ave",value:y}),s.a.createElement(d.b,{on:b,onToggle:function(e){return a(e)}}),s.a.createElement(p.a,{position:E,onSetPosition:function(e){return c(e)}}),s.a.createElement(d.a,{isConnected:_,isConnecting:C,onToggle:function(e){return e?o():i()}}))}}]),n}(s.a.Component))||c},227:function(e,n,t){"use strict";function r(e){var n="rotate("+e+"deg)";return{transform:n,"-webkit-transform":n,"-moz-transform":n}}t.d(n,"e",function(){return d}),t.d(n,"g",function(){return p}),t.d(n,"f",function(){return v}),t.d(n,"b",function(){return h}),t.d(n,"a",function(){return m}),t.d(n,"d",function(){return g}),t.d(n,"c",function(){return y});var o=t(11),i=t.n(o),a=t(97),c=t.n(a),u=t(228),s=t.n(u),l=t(229),f=t.n(l),d=function(e){var n=e.id,t=e.value;return i.a.createElement("div",{id:n,className:"numeric-display"},c.a(t).format("0,0.0"))},p=function(e){var n=e.id,t=e.value;return i.a.createElement("div",{id:n,className:"numeric-gauge-digital"},c.a(t%1e3).format("000"))},v=function(e){var n=e.id,t=e.value;return i.a.createElement("div",{id:n,className:"numeric-gauge-analog"},c.a(t%1e3).format("0.0"))},h=function(e){var n=e.on,t=e.onToggle;return i.a.createElement("div",{id:"landing-gear-status",className:n?"on":"off",onClick:function(){return t(!n)}})},m=function(e){var n=e.isConnected,t=e.isConnecting,r=e.onToggle;return n?i.a.createElement("div",{id:"connection-status",className:"connected",onClick:function(){return r(!1)}},"Connected"):t?i.a.createElement("div",{id:"connection-status",className:"connecting",onClick:function(){return r(!1)}},"Connecting"):i.a.createElement("div",{id:"connection-status",className:"disconnected",onClick:function(){return r(!0)}},"Disconnected")},g=function(e){var n=e.id,t=e.value,o=e.max;return i.a.createElement("div",{id:n,className:"gauge-needle",style:r(t/o*360)},i.a.createElement("img",{src:f.a}))},y=function(e){var n=e.id,t=e.value,o=e.max;return i.a.createElement("div",{id:n},i.a.createElement("div",{className:"gauge-needle",style:r(t/o*360)},i.a.createElement("img",{src:f.a})),i.a.createElement("div",{className:"gauge-needle",style:r(t/(10*o)*360)},i.a.createElement("img",{src:s.a})))}},228:function(e,n,t){e.exports=t.p+"needle-small.png?b0778be53c581c4ee8bba501771b8cca"},229:function(e,n,t){e.exports=t.p+"needle-big.png?80aed0bcf7e2900c34b90ecd6f3db938"},23:function(e,n,t){"use strict";t.d(n,"c",function(){return i}),t.d(n,"b",function(){return a}),t.d(n,"f",function(){return c}),t.d(n,"g",function(){return u}),t.d(n,"i",function(){return s}),t.d(n,"h",function(){return l}),t.d(n,"a",function(){return f}),t.d(n,"e",function(){return d});var r=t(96),o={CONNECTING:"CONNECTING",CONNECTED:"CONNECTED",DISCONNECTED:"DISCONNECTED",RECEIVE_DATA:"RECEIVE_DATA",TOGGLE_LANDING_GEAR:"TOGGLE_LANDING_GEAR",SET_FLAPS_POSITION:"SET_FLAPS_POSITION"},i=function(){return{type:o.CONNECTING}},a=function(){return{type:o.CONNECTED}},c=function(){return{type:o.DISCONNECTED}},u=function(e){return{type:o.RECEIVE_DATA,payload:e}},s=function(e){return function(n){n({type:o.TOGGLE_LANDING_GEAR,payload:{on:e}}),r.a.toggleLandingGear(e)}},l=function(e){return function(n){n({type:o.SET_FLAPS_POSITION,payload:{position:e}}),r.a.setFlapsPosition(e)}},f=function(){return function(e){return r.a.connectToServer()}},d=function(){return function(e){return r.a.disconnectFromServer()}};n.d=o},230:function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function o(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}function i(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}t.d(n,"a",function(){return s});var a=t(11),c=t.n(a),u=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),s=function(e){function n(){return r(this,n),o(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return i(n,e),u(n,[{key:"componentDidMount",value:function(){var e=this;$(this.refs.handle).draggable({grid:[24,0],containment:"parent",stop:function(n,t){var r=t.position;return e.props.onSetPosition(r.left/24)}})}},{key:"render",value:function(){var e=this.props.position;return c.a.createElement("div",{id:"flaps-status"},c.a.createElement("div",{className:"handle",ref:"handle",style:{left:24*e+"px"}}))}}]),n}(c.a.Component)},96:function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var o=t(221),i=t(222),a=t(223),c=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),u=function(){function e(){var n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];r(this,e),this.connection=null,this.shouldBeConnected=!1,this.autoReconnect=n,this.callbacks={},this.speedMetaBuffer=new a.a,this.altitudeMetaBuffer=new a.a}return c(e,[{key:"url",get:function(){return"ws://interview.dev.ctx.ef.com/telemetry"}}]),c(e,[{key:"setCallbacks",value:function(e){var n=e.onConnecting,t=e.onConnected,r=e.onDisconnected,o=e.onMessage,i=e.onError;this.callbacks.onConnecting=n,this.callbacks.onConnected=t,this.callbacks.onDisconnected=r,this.callbacks.onMessage=o,this.callbacks.onError=i}},{key:"connectToServer",value:function(){this.shouldBeConnected=!0,this._onConnecting(),this.connection=new o.a(this.url,{onOpen:this._onConnected.bind(this),onClose:this._onDisconnected.bind(this),onMessage:this._onMessage.bind(this),onError:this._onError.bind(this)})}},{key:"disconnectFromServer",value:function(){this.shouldBeConnected=!1,this.connection.close(),this.connection=null}},{key:"toggleLandingGear",value:function(e){this.connection&&this.connection.send({control:{landing_gear:e}})}},{key:"setFlapsPosition",value:function(e){this.connection&&this.connection.send({control:{flaps:e}})}},{key:"_onConnecting",value:function(){this.callbacks.onConnecting&&this.callbacks.onConnecting()}},{key:"_onConnected",value:function(){this.callbacks.onConnected&&this.callbacks.onConnected()}},{key:"_onDisconnected",value:function(){this.callbacks.onDisconnected&&this.callbacks.onDisconnected(),this.shouldBeConnected&&this.autoReconnect&&setTimeout(this.connectToServer.bind(this),1e3)}},{key:"_onMessage",value:function(e){var n=this;i.a(e.data).then(function(e){return n._calculateMetaData(e)}).then(function(e){return n.callbacks.onMessage&&n.callbacks.onMessage(e)}).catch(function(e){return n._onError(e)})}},{key:"_onError",value:function(e){this.callbacks.onError&&this.callbacks.onError(e)}},{key:"_calculateMetaData",value:function(e){var n=this;return new Promise(function(t){var r=e.telemetry,o=r.airspeed,i=r.altitude,a=e.control;n.speedMetaBuffer.update(i),n.altitudeMetaBuffer.update(o),t({telemetry:{airspeed:o,altitude:i,minSpeed:n.speedMetaBuffer.min,maxSpeed:n.speedMetaBuffer.max,averageSpeed:n.speedMetaBuffer.average,minAltitude:n.altitudeMetaBuffer.min,maxAltitude:n.altitudeMetaBuffer.max,averageAltitude:n.altitudeMetaBuffer.average},control:a})})}}]),e}();n.a=new u},98:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(99),o=(t.n(r),t(11)),i=t.n(o),a=t(58),c=t.n(a),u=t(190);c.a.render(i.a.createElement(u.a,null),document.getElementById("app"))},99:function(e,n){}},[98]);